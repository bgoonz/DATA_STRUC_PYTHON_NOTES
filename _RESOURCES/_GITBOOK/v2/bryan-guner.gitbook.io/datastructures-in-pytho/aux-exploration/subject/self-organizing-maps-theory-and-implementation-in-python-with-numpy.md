<a href="https://bryan-guner.gitbook.io/datastructures-in-pytho/" class="link-a079aa82--primary-53a25e66--logoLink-10d08504"></a>

<img src="https://gblobscdn.gitbook.com/spaces%2F-Mij72ebV4OjqJvBacMy%2Favatar-1631135591697.png?alt=media" class="image-67b14f24--avatar-1c1d03ec" />

<span class="text-4505230f--UIH400-4e41e82a--textContentFamily-49a318e1--spaceNameText-677c2969">datastructures-in-python</span>

<a href="https://bryan-guner.gitbook.io/datastructures-in-pytho/" class="link-a079aa82--primary-53a25e66--logoLink-10d08504"></a>

<img src="https://gblobscdn.gitbook.com/spaces%2F-Mij72ebV4OjqJvBacMy%2Favatar-1631135591697.png?alt=media" class="image-67b14f24--avatar-1c1d03ec" />

<span class="text-4505230f--UIH400-4e41e82a--textContentFamily-49a318e1--spaceNameText-677c2969">datastructures-in-python</span>

<a href="https://bgoonz-blog.netlify.app/#gsc.tab=0" class="button-36063075--medium-6e2a217a--button-f76f0854--linkButton-67c61496--links-3087c5dc"><span class="text-4505230f--UIH400-4e41e82a--textContentFamily-49a318e1--text-8ee2c8b2"><span class="text-4505230f--UIH400-4e41e82a--textContentFamily-49a318e1">My Blog</span></span></a>

<a href="https://www.notion.so/webdevhub42/Python-Data-Structures-Unit-1da9a5d55db844f4b62aff6fd2b4d1ce" class="button-36063075--medium-6e2a217a--button-f76f0854--linkButton-67c61496--links-3087c5dc"><span class="text-4505230f--UIH400-4e41e82a--textContentFamily-49a318e1--text-8ee2c8b2"><span class="text-4505230f--UIH400-4e41e82a--textContentFamily-49a318e1">Notion Notes</span></span></a>

<a href="https://bgoonz-branch-the-algos.vercel.app/" class="button-36063075--medium-6e2a217a--button-f76f0854--linkButton-67c61496--links-3087c5dc"><span class="text-4505230f--UIH400-4e41e82a--textContentFamily-49a318e1--text-8ee2c8b2"><span class="text-4505230f--UIH400-4e41e82a--textContentFamily-49a318e1">The Algorithms</span></span></a>

<a href="https://thealgorithms.netlify.app/#" class="button-36063075--medium-6e2a217a--button-f76f0854--linkButton-67c61496--links-3087c5dc"><span class="text-4505230f--UIH400-4e41e82a--textContentFamily-49a318e1--text-8ee2c8b2"><span class="text-4505230f--UIH400-4e41e82a--textContentFamily-49a318e1">Python Module Website</span></span></a>

<a href="https://bryan-guner.gitbook.io/datastructures-in-pytho/" class="link-a079aa82--primary-53a25e66--logoLink-10d08504"></a>

<img src="https://gblobscdn.gitbook.com/spaces%2F-Mij72ebV4OjqJvBacMy%2Favatar-1631135591697.png?alt=media" class="image-67b14f24--avatar-1c1d03ec" />

<span class="text-4505230f--UIH400-4e41e82a--textContentFamily-49a318e1--spaceNameText-677c2969">datastructures-in-python</span>

<a href="https://bryan-guner.gitbook.io/datastructures-in-pytho/" class="link-a079aa82--primary-53a25e66--logoLink-10d08504"></a>

<img src="https://gblobscdn.gitbook.com/spaces%2F-Mij72ebV4OjqJvBacMy%2Favatar-1631135591697.png?alt=media" class="image-67b14f24--avatar-1c1d03ec" />

<span class="text-4505230f--UIH400-4e41e82a--textContentFamily-49a318e1--spaceNameText-677c2969">datastructures-in-python</span>

<span class="text-4505230f--UIH400-4e41e82a--textUIFamily-5ebd8e40--text-8ee2c8b2"></span>

<a href="https://bryan-guner.gitbook.io/datastructures-in-pytho/" class="navButton-94f2579c--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Home</span></a>

<a href="../../index.html" class="navButton-94f2579c--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Downloads &amp; Misc-Assets</span></a>

<a href="../../readme-1.html" class="navButton-94f2579c--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">README</span></a>

<a href="../../navigation.html" class="navButton-94f2579c--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Navigation</span></a>

<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f"><span class="text-4505230f--InfoH200-3a8a7a86--textContentFamily-49a318e1">Curriculum</span></span>

<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Outline</span>

<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">wk17</span>

<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">wk18</span>

<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">wk19</span>

<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">wk20</span>

<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f"><span class="text-4505230f--InfoH200-3a8a7a86--textContentFamily-49a318e1">Utilities</span></span>

<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Utilites</span>

<a href="../../utilities/code-lab-notebooks.html" class="navButton-94f2579c--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Code lab Notebooks</span></a>

<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Repl.IT</span>

<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f"><span class="text-4505230f--InfoH200-3a8a7a86--textContentFamily-49a318e1">Abstract Data Structures</span></span>

<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Algorithms</span>

<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Data Structures Overview</span>

<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Abstract Data Structures:</span>

<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f"><span class="text-4505230f--InfoH200-3a8a7a86--textContentFamily-49a318e1">practice</span></span>

<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">GCA Sprint Prep:</span>

<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Supplemental Practice:</span>

<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f"><span class="text-4505230f--InfoH200-3a8a7a86--textContentFamily-49a318e1">Resources</span></span>

<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Python Cheat Sheet</span>

<a href="../../resources/youtube.html" class="navButton-94f2579c--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Youtube</span></a>

<a href="../../resources/pdf-downloads.html" class="navButton-94f2579c--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">PDF Downloads</span></a>

<a href="../../resources/intro-2-python.html" class="navButton-94f2579c--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Intro 2 Python</span></a>

<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Dictionaries</span>

<a href="../../resources/python-vs-javascript.html" class="navButton-94f2579c--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Python VS JavaScript</span></a>

<a href="../../resources/untitled-1.html" class="navButton-94f2579c--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Misc. Resources</span></a>

<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Things To Internalize:</span>

<a href="../../resources/intro-to-python-w-jupyter-notebooks.html" class="navButton-94f2579c--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Intro To Python w Jupyter Notebooks</span></a>

<a href="../../resources/calculating-big-o.html" class="navButton-94f2579c--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Calculating Big O</span></a>

<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Useful Links</span>

<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f"><span class="text-4505230f--InfoH200-3a8a7a86--textContentFamily-49a318e1">Docs</span></span>

<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Docs</span>

<a href="../../stdlib/queue-and-stacks.html" class="navButton-94f2579c--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Queue &amp; Stacks</span></a>

<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f"><span class="text-4505230f--InfoH200-3a8a7a86--textContentFamily-49a318e1">quick-reference</span></span>

<a href="../../quick-reference/my-medium-articles.html" class="navButton-94f2579c--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">My Medium Articles</span></a>

<a href="../../quick-reference/free-python-books.html" class="navButton-94f2579c--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Free Python Books</span></a>

<a href="../../quick-reference/why-python.html" class="navButton-94f2579c--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">WHY Python?</span></a>

<a href="../../quick-reference/python-snippets.html" class="navButton-94f2579c--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Python Snippets</span></a>

<a href="../../quick-reference/python3-regex.html" class="navButton-94f2579c--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Python3 Regex</span></a>

<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Python Module Index:</span>

<a href="../../quick-reference/creating-python-modules.html" class="navButton-94f2579c--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Creating Python Modules</span></a>

<a href="../../quick-reference/untitled.html" class="navButton-94f2579c--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Useful Info</span></a>

<a href="../../quick-reference/python-glossary.html" class="navButton-94f2579c--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Python Glossary</span></a>

<a href="../../quick-reference/untitled-1.html" class="navButton-94f2579c--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Python Snippets</span></a>

<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f"><span class="text-4505230f--InfoH200-3a8a7a86--textContentFamily-49a318e1">MISC</span></span>

<a href="../../misc/built-in-methods-and-functions.html" class="navButton-94f2579c--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Built-in Methods &amp; Functions</span></a>

<a href="../../misc/data-structures-types.html" class="navButton-94f2579c--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Data Structures Types</span></a>

<a href="../../misc/math.html" class="navButton-94f2579c--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Math</span></a>

<a href="../../misc/unsorted-examples.html" class="navButton-94f2579c--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Unsorted Examples</span></a>

<a href="../../misc/outline.html" class="navButton-94f2579c--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Outline</span></a>

<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">About Python</span>

<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f"><span class="text-4505230f--InfoH200-3a8a7a86--textContentFamily-49a318e1">Interview Prep</span></span>

<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Interview Resources</span>

<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f"><span class="text-4505230f--InfoH200-3a8a7a86--textContentFamily-49a318e1">Installations Setup & Env</span></span>

<a href="../../installations-setup-and-env/untitled.html" class="navButton-94f2579c--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">python-setup</span></a>

<a href="../../installations-setup-and-env/installing-python-modules.html" class="navButton-94f2579c--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Installing Python Modules</span></a>

<a href="../../installations-setup-and-env/set-up-virtual-enviornment.html" class="navButton-94f2579c--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Set Up Virtual Enviornment</span></a>

<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f"><span class="text-4505230f--InfoH200-3a8a7a86--textContentFamily-49a318e1">Aux-Exploration</span></span>

<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Related Studies</span>

<a href="self-organizing-maps-theory-and-implementation-in-python-with-numpy.html" class="navButton-94f2579c--pageItemWithChildrenNested-2c5d8183--navButtonClickable-161b88ca--navButtonOpened-6a88552e"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Self-Organizing Maps: Theory and Implementation in Python with NumPy</span></a>

<a href="list-directory-contents.html" class="navButton-94f2579c--pageItemWithChildrenNested-2c5d8183--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">List Directory Contents</span></a>

<a href="untitled-5.html" class="navButton-94f2579c--pageItemWithChildrenNested-2c5d8183--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Employee Manager</span></a>

<a href="untitled-4.html" class="navButton-94f2579c--pageItemWithChildrenNested-2c5d8183--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">OS Module</span></a>

<a href="untitled-3.html" class="navButton-94f2579c--pageItemWithChildrenNested-2c5d8183--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">server-side-scripting</span></a>

<a href="untitled-2.html" class="navButton-94f2579c--pageItemWithChildrenNested-2c5d8183--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Reading and Writing to text files in Python</span></a>

<a href="untitled-1.html" class="navButton-94f2579c--pageItemWithChildrenNested-2c5d8183--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">General Data Structures</span></a>

<a href="touple.html" class="navButton-94f2579c--pageItemWithChildrenNested-2c5d8183--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Touple</span></a>

<a href="untitled.html" class="navButton-94f2579c--pageItemWithChildrenNested-2c5d8183--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">How to round Python values to whole numbers?</span></a>

<a href="python-array-module.html" class="navButton-94f2579c--pageItemWithChildrenNested-2c5d8183--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Python Array Module</span></a>

<a href="data-structures-in-javascript.html" class="navButton-94f2579c--pageItemWithChildrenNested-2c5d8183--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Data Structures In JavaScript</span></a>

<a href="dunder-methods.html" class="navButton-94f2579c--pageItemWithChildrenNested-2c5d8183--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Dunder Methods</span></a>

<a href="python-github-api.html" class="navButton-94f2579c--pageItemWithChildrenNested-2c5d8183--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Python GitHub API</span></a>

<a href="js-event-loop.html" class="navButton-94f2579c--pageItemWithChildrenNested-2c5d8183--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">JS-Event Loop</span></a>

<a href="javascript-event-loop.html" class="navButton-94f2579c--pageItemWithChildrenNested-2c5d8183--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">JavaScript Event Loop</span></a>

<span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f"><span class="text-4505230f--InfoH200-3a8a7a86--textContentFamily-49a318e1">experiments</span></span>

<a href="../../experiments/untitled.html" class="navButton-94f2579c--navButtonClickable-161b88ca"><span class="text-4505230f--UIH300-2063425d--textContentFamily-49a318e1--navButtonLabel-14a4968f">Untitled</span></a>

<a href="https://www.gitbook.com/?utm_source=content&amp;utm_medium=trademark&amp;utm_campaign=bryan-guner" class="reset-3c756112--trademark-a8da4b94"></a>

<span class="text-4505230f--TextH200-a3425406--textUIFamily-5ebd8e40">Powered by **GitBook**</span>

<span class="text-4505230f--DisplayH900-bfb998fa--textContentFamily-49a318e1">Self-Organizing Maps: Theory and Implementation in Python with NumPy</span>
=========================================================================================================================================================

<span class="text-4505230f--UIH300-2063425d--textUIFamily-5ebd8e40--text-8ee2c8b2"></span>

### 

<span class="text-4505230f--HeadingH400-686c0942--textContentFamily-49a318e1"><span data-key="e5268e15bb8d4cd3aa1cdf0d0478588c"><span data-offset-key="e5268e15bb8d4cd3aa1cdf0d0478588c:0">Introduction</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="72a3ec33726244488866ebb97b441a3b"><span data-offset-key="72a3ec33726244488866ebb97b441a3b:0">In this guide, we'll be taking a look at an unsupervised learning model, known as a </span><span data-offset-key="72a3ec33726244488866ebb97b441a3b:1">***Self-Organizing Map (SOM)***</span><span data-offset-key="72a3ec33726244488866ebb97b441a3b:2">, as well as its implementation in Python. We'll be using an </span><span data-offset-key="72a3ec33726244488866ebb97b441a3b:3">**RGB Color**</span><span data-offset-key="72a3ec33726244488866ebb97b441a3b:4"> example to train the SOM and demonstrate its performance and typical usage.</span></span></span>

### 

<span class="text-4505230f--HeadingH400-686c0942--textContentFamily-49a318e1"><span data-key="c79d5bd673ef4ad59bf77259b65b2e96"><span data-offset-key="c79d5bd673ef4ad59bf77259b65b2e96:0">Self-Organizing Maps: A General Introduction</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="4b939d4a6ffb4d87948a7afe1edba753"><span data-offset-key="4b939d4a6ffb4d87948a7afe1edba753:0">A </span><span data-offset-key="4b939d4a6ffb4d87948a7afe1edba753:1">*Self-Organizing Map*</span><span data-offset-key="4b939d4a6ffb4d87948a7afe1edba753:2"> was first introduced by </span></span><a href="https://link.springer.com/article/10.1007/BF00337288" class="link-a079aa82--primary-53a25e66--link-faf6c434"><span data-key="95c7115f9fde4dd5a0762e464b90e4b3"><span data-offset-key="95c7115f9fde4dd5a0762e464b90e4b3:0">Teuvo Kohonen in 1982</span></span></a><span data-key="ec7feafb97ff4a8c9789637417f136be"><span data-offset-key="ec7feafb97ff4a8c9789637417f136be:0"> and is also sometimes known as a </span><span data-offset-key="ec7feafb97ff4a8c9789637417f136be:1">***Kohonen map***</span><span data-offset-key="ec7feafb97ff4a8c9789637417f136be:2">. It is a special type of an </span><span data-offset-key="ec7feafb97ff4a8c9789637417f136be:3">*artificial neural network*</span><span data-offset-key="ec7feafb97ff4a8c9789637417f136be:4">, which builds a map of the training data. The map is generally a 2D rectangular grid of weights but can be extended to a 3D or higher dimensional model. Other grid structures like hexagonal grids are also possible.</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="a55a488e79244fcfa93c93a0706832b5"><span data-offset-key="a55a488e79244fcfa93c93a0706832b5:0">An SOM is mainly used for data visualization and provides a quick visual summary of the training instances. In a 2D rectangular grid, each cell is represented by a weight vector. For a trained SOM, each cell weight represents a summary of a few training examples. Cells in the close vicinity of each other have similar weights, and like examples can be mapped to cells in a small neighborhood of each other.</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="a0a941cb58cf42a68abd9f40b5d2ecfe"><span data-offset-key="a0a941cb58cf42a68abd9f40b5d2ecfe:0">The figure below is a rough illustration of the structure of the SOM:</span></span></span>

<figure><img src="https://s3.stackabuse.com/media/articles/self-organizing-maps-theory-and-implementation-in-python-with-numpy-0.png" alt="self-organizing map illustration" class="image-52799b3c" /><figcaption><span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1" style="max-width:100%">self-organizing map illustration</span></figcaption></figure>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="bb87ceead3f1478c9cbf3e6a2afa4efa"><span data-offset-key="bb87ceead3f1478c9cbf3e6a2afa4efa:0">An SOM is trained using </span><span data-offset-key="bb87ceead3f1478c9cbf3e6a2afa4efa:1">**competitive learning**</span><span data-offset-key="bb87ceead3f1478c9cbf3e6a2afa4efa:2">.</span></span></span>

> <span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="c17989faf2ce44e1abd12b8b68d4aa5e"><span data-offset-key="c17989faf2ce44e1abd12b8b68d4aa5e:0">**Competitive Learning**</span><span data-offset-key="c17989faf2ce44e1abd12b8b68d4aa5e:1"> is a form of unsupervised learning, where constituent elements compete to produce a satisfying result, and only one gets to win the competition.</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="23cb147e057b415f8961124eaf334a4a"><span data-offset-key="23cb147e057b415f8961124eaf334a4a:0">When a training example is input into the grid, the </span><span data-offset-key="23cb147e057b415f8961124eaf334a4a:1">***Best Matching Unit (BMU)***</span><span data-offset-key="23cb147e057b415f8961124eaf334a4a:2"> is determined (competition winner). The BMU is the cell whose weights are closest to the training example.</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="4c2bb519d50f4463937bc3d02f416f03"><span data-offset-key="4c2bb519d50f4463937bc3d02f416f03:0">Next, the BMU's weights and weights of the cells neighboring the BMU, are adapted to move closer to the input training instance. While there are other valid variants of training an SOM, we present the most popular and widely used implementation of the SOM in this guide.</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="ffa225d6fbd443f89074c63e8a3bb479"><span data-offset-key="ffa225d6fbd443f89074c63e8a3bb479:0">As we'll be using some Python routines to demonstrate the functions used to train an SOM, let's import a few of the libraries we'll be using:</span></span></span>

    import numpy as npimport matplotlib.pyplot as plt

### 

<span class="text-4505230f--HeadingH400-686c0942--textContentFamily-49a318e1"><span data-key="add2e873f91e42cab3cd124d14cb9b3d"><span data-offset-key="add2e873f91e42cab3cd124d14cb9b3d:0">The Algorithm Behind Training Self-Organizing Maps</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="22f8f2183a4d4d9d9e18bfe006b491ab"><span data-offset-key="22f8f2183a4d4d9d9e18bfe006b491ab:0">The basic algorithm for training an SOM is given below:</span></span></span>

-   <span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="a5fff28f3a64489a883147010d10b89a"><span data-offset-key="a5fff28f3a64489a883147010d10b89a:0">Initialize all grid weights of the SOM</span></span></span>

-   <span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="1e5dd0ce4c2a4c17a3b92128b829fe3d"><span data-offset-key="1e5dd0ce4c2a4c17a3b92128b829fe3d:0">Repeat until convergence or maximum epochs are reached</span></span></span>

    -   <span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="ac5686cbf77e471e8a9c54c7179086c8"><span data-offset-key="ac5686cbf77e471e8a9c54c7179086c8:0">Shuffle the training examples</span></span></span>

    -   <span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="e3eb5d43dddf4c748069be0c47aab0ab"><span data-offset-key="e3eb5d43dddf4c748069be0c47aab0ab:0">For each training instance xx</span></span></span>

        -   <span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="2e92f8df035c4e829fe23e4373845b66"><span data-offset-key="2e92f8df035c4e829fe23e4373845b66:0">Find the best matching unit BMU</span></span></span>

        -   <span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="0b4c36ac5d394407ad451af7587390ae"><span data-offset-key="0b4c36ac5d394407ad451af7587390ae:0">Update the weight vector of BMU and its neighboring cells</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="e0b3fd34531b48f8961f7aaae59261df"><span data-offset-key="e0b3fd34531b48f8961f7aaae59261df:0">The three steps for initialization, finding the BMU, and updating the weights are explained in the following sections. Let's begin!</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="44f6e648053a46f0b0501e2af3731f13"><span data-offset-key="44f6e648053a46f0b0501e2af3731f13:0">**Initializing the SOM GRID**</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="d562d4c8831046e8bf0decb989a2b812"><span data-offset-key="d562d4c8831046e8bf0decb989a2b812:0">All the SOM grid weights can be initialized randomly. The SOM grid weights can also be initialized by randomly chosen examples from the training dataset.</span></span></span>

> <span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="54182c8d7f25408d9cc613c107bb4839"><span data-offset-key="54182c8d7f25408d9cc613c107bb4839:0">Which one should you choose?</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="302fc4f34644475187540d79c0259eab"><span data-offset-key="302fc4f34644475187540d79c0259eab:0">SOMs are sensitive to the initial weight of the map, so this choice affects the overall model. According to </span></span><a href="https://arxiv.org/ftp/arxiv/papers/1210/1210.5873.pdf" class="link-a079aa82--primary-53a25e66--link-faf6c434"><span data-key="54f5a2f54d764d069018fdc8157c81b5"><span data-offset-key="54f5a2f54d764d069018fdc8157c81b5:0">a case study</span></span></a><span data-key="06197686a75c49c0af02f2d3a2a79454"><span data-offset-key="06197686a75c49c0af02f2d3a2a79454:0"> performed by Ayodeji and Evgeny of University of Leicester and Siberian Federal University:</span></span></span>

> <span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="7098656f9e3d412185cabc0461b698e5"><span data-offset-key="7098656f9e3d412185cabc0461b698e5:0">By comparing the proportion of final SOM map of </span><span data-offset-key="7098656f9e3d412185cabc0461b698e5:1">**RI (Random Initialization)**</span><span data-offset-key="7098656f9e3d412185cabc0461b698e5:2"> which outperformed </span><span data-offset-key="7098656f9e3d412185cabc0461b698e5:3">**PCI (Principal Component Initialization)**</span><span data-offset-key="7098656f9e3d412185cabc0461b698e5:4"> under the same conditions, it was observed that RI performed quite well for non-linear data sets.</span></span></span>
>
> <span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="34ed213ea4da41eba06e361563315c98"><span data-offset-key="34ed213ea4da41eba06e361563315c98:0">However for quasi-linear datasets, the result remains inconclusive. In general, we can conclude that the hypothesis about advantages of the PCI is definitely wrong for essentially nonlinear datasets.</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="834fa9d80b8142df8032a3f75b7182f1"><span data-offset-key="834fa9d80b8142df8032a3f75b7182f1:0">Random initialization outperforms non-random initialization for non-linear datasets. For quasi-linear datasets, it's not quite clear what approach wins consistently. Given these results - we'll stick to </span><span data-offset-key="834fa9d80b8142df8032a3f75b7182f1:1">**random initialization**</span><span data-offset-key="834fa9d80b8142df8032a3f75b7182f1:2">.</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="22e423a96fe74f9f833db9c8ac41d60f"><span data-offset-key="22e423a96fe74f9f833db9c8ac41d60f:0">**Finding the Best Matching Unit (BMU)**</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="9654f49bb82a4d1b957479e2a2d6f3bc"><span data-offset-key="9654f49bb82a4d1b957479e2a2d6f3bc:0">As mentioned earlier, the best matching unit is the cell of the SOM grid that is closest to the training example xx. One method of finding this unit is to compute the </span><span data-offset-key="9654f49bb82a4d1b957479e2a2d6f3bc:1">**Euclidean distance**</span><span data-offset-key="9654f49bb82a4d1b957479e2a2d6f3bc:2"> of xx from the weight of each cell of the grid.</span></span></span>

> <span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="6e06ba4f0b9a4f62b56ba79685da0eaf"><span data-offset-key="6e06ba4f0b9a4f62b56ba79685da0eaf:0">The cell with the minimum distance can be chosen as the BMU.</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="37e60418faef4839b6e56e339c5bf7db"><span data-offset-key="37e60418faef4839b6e56e339c5bf7db:0">An important point to note is that Euclidean distance is not the only possible method of selecting the BMU. An alternative distance measure or a similarity metric can also be used to determine the BMU, and choosing this mainly depends on the data and model you're building specifically.</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="57adc8711f5249ff925f78dd5ad7e865"><span data-offset-key="57adc8711f5249ff925f78dd5ad7e865:0">**Updating the Weight Vector of BMU and Neighboring Cells**</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="d011849c8d184f3dab6c259ddb7d58b4"><span data-offset-key="d011849c8d184f3dab6c259ddb7d58b4:0">A training example xx effects various cells of the SOM grid by pulling the weights of these cells towards it. The maximum change occurs in the BMU and the influence of xx diminishes as we move away from the BMU in the SOM grid. For a cell with coordinates (i,j)(i,j), its weight wijwij is updated at epoch t+1t+1 as:</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="b3274c2fe8854ce2bd3adc9d2a838a77"><span data-offset-key="b3274c2fe8854ce2bd3adc9d2a838a77:0">w(t+1)ij←w(t)ij+Δw(t)ijwij(t+1)←wij(t)+Δwij(t)</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="f215595913b14065b22551b2c4916dd7"><span data-offset-key="f215595913b14065b22551b2c4916dd7:0">Where Δw(t)ijΔwij(t) is the change to be added to w(t)ijwij(t). It can be computed as:</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="8d25c9033c474930b1b003c4c46ce0f4"><span data-offset-key="8d25c9033c474930b1b003c4c46ce0f4:0">Δw(t)ij=η(t)fi,j(g,h,σt)(x−w(t)ij)Δwij(t)=η(t)fi,j(g,h,σt)(x−wij(t))</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="ff0d5524c53b423dad047d5e9c4051f5"><span data-offset-key="ff0d5524c53b423dad047d5e9c4051f5:0">For this expression:</span></span></span>

-   <span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="7e743c44e49e4766ae9663c37a19412f"><span data-offset-key="7e743c44e49e4766ae9663c37a19412f:0">tt is the epoch number</span></span></span>

-   <span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="d9b22353927d41abb7fdf81dcd9cc922"><span data-offset-key="d9b22353927d41abb7fdf81dcd9cc922:0">(g,h)(g,h) are the coordinates of BMU</span></span></span>

-   <span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="c11cd230a09e4822b522f3575b97921a"><span data-offset-key="c11cd230a09e4822b522f3575b97921a:0">ηη is the learning rate</span></span></span>

-   <span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="2f81ef6e0644479189d5dbbd8ea5db25"><span data-offset-key="2f81ef6e0644479189d5dbbd8ea5db25:0">σtσt is the radius</span></span></span>

-   <span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="9d307b2b70914cca896302a0af5a8c6e"><span data-offset-key="9d307b2b70914cca896302a0af5a8c6e:0">fij(g,h,σt)fij(g,h,σt) is the neighborhood distance function</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="34a3521945b740668479d2a406dfed77"><span data-offset-key="34a3521945b740668479d2a406dfed77:0">In the following sections, we'll present the details of this weight training expression.</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="d9e3d5c92d924437908a1ea086332de8"><span data-offset-key="d9e3d5c92d924437908a1ea086332de8:0">**The Learning Rate**</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="a00d49e5698040daa452c3db1b5f488e"><span data-offset-key="a00d49e5698040daa452c3db1b5f488e:0">The learning rate ηη is a constant in the range \[0,1\] and determines the step size of the weight vector towards the input training example. For η=0η=0, there is no change in the weight, and when η=1η=1 the weight vector wijwij take the value of xx.</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="2aa4b64f44c54893affdcfd26a22d9b0"><span data-offset-key="2aa4b64f44c54893affdcfd26a22d9b0:0">ηη is kept high at the start and decayed as the epochs proceed. One strategy for reducing the learning rate during the training phase is to use exponential decay:</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="9ac5bdd634a14445974b933aabd01315"><span data-offset-key="9ac5bdd634a14445974b933aabd01315:0">η(t)=η0e−t∗λη(t)=η0e−t∗λ</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="c217c5e905724da89652f4b6706fe197"><span data-offset-key="c217c5e905724da89652f4b6706fe197:0">Where λ&lt;0λ&lt;0 is the decay rate.</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="e9f3e8626b214ed8ba1d2ea5739fe402"><span data-offset-key="e9f3e8626b214ed8ba1d2ea5739fe402:0">To understand how the learning rate changes with the decay rate, let's plot the learning rate against various epochs when the initial learning rate is set to one:</span></span></span>

    epochs = np.arange(0, 50)lr_decay = [0.001, 0.1, 0.5, 0.99]fig,ax = plt.subplots(nrows=1, ncols=4, figsize=(15,4))plt_ind = np.arange(4) + 141for decay, ind in zip(lr_decay, plt_ind):    plt.subplot(ind)    learn_rate = np.exp(-epochs * decay)    plt.plot(epochs, learn_rate, c='cyan')    plt.title('decay rate: ' + str(decay))    plt.xlabel('epochs $t$')    plt.ylabel('$\eta^(t)$')fig.subplots_adjust(hspace=0.5, wspace=0.3)plt.show()

<figure><img src="https://s3.stackabuse.com/media/articles/self-organizing-maps-theory-and-implementation-in-python-with-numpy-1.png" alt="learning rates for self organizing maps" class="image-52799b3c" /><figcaption><span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1" style="max-width:100%">learning rates for self organizing maps</span></figcaption></figure>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="79a037f601284abcb451df516220ba6e"><span data-offset-key="79a037f601284abcb451df516220ba6e:0">**The Neighborhood Distance Function**</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="caeb2a1b23f648f6ac2c68880d5d3fc8"><span data-offset-key="caeb2a1b23f648f6ac2c68880d5d3fc8:0">The neighborhood distance function is given by:</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="001a8932311345b2a27831dbbe44b564"><span data-offset-key="001a8932311345b2a27831dbbe44b564:0">fij(g,h,σt)=e−d((i,j),(g,h))22σ2tfij(g,h,σt)=e−d((i,j),(g,h))22σt2</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="904f263d7fa34c8eb349219ec78c0770"><span data-offset-key="904f263d7fa34c8eb349219ec78c0770:0">where d((i,j),(g,h))d((i,j),(g,h)) is the distance of coordinates (i,j)(i,j) of a cell from the BMU's coordinates (g,h)(g,h), and σtσt is the radius at epoch tt. Normally Euclidean distance is used to compute the distance, however, any other distance or similarity metric can be used.</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="fbdf5a9a6170482ab95d4e6000b6b6aa"><span data-offset-key="fbdf5a9a6170482ab95d4e6000b6b6aa:0">As the distance of BMU with itself is zero, the weight change of the BMU reduces to:</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="f4ef12952c22479bb8ff580ecff6ffb0"><span data-offset-key="f4ef12952c22479bb8ff580ecff6ffb0:0">Δwgh=η(x−wgh)Δwgh=η(x−wgh)</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="0054007062884f6ca8dbe46119dd41b7"><span data-offset-key="0054007062884f6ca8dbe46119dd41b7:0">For a unit (i,j)(i,j) having a large distance from the BMU, the neighborhood distance function reduces to a near-zero value, leading to a very small magnitude of ΔwijΔwij. Hence, such units are unaffected by the training example xx. One training example, therefore, only affects the BMU and the cells in the close vicinity of the BMU. As we move away from the BMU the change in weights becomes less and less until it is negligible.</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="786a763d262c4e19b632d232e1ac7959"><span data-offset-key="786a763d262c4e19b632d232e1ac7959:0">The radius determines the influence region of a training example xx. A high radius value affects a larger number of cells and a smaller radius affects only the BMU. A common strategy is to start with a large radius and reduce it as the epochs proceed, i.e.:</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="d5798de8c5ad4c4f93917ba585d5309e"><span data-offset-key="d5798de8c5ad4c4f93917ba585d5309e:0">σt=σ0e−t∗βσt=σ0e−t∗β</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="ea0a15babdfa42d8b6c05f769fb4a3cb"><span data-offset-key="ea0a15babdfa42d8b6c05f769fb4a3cb:0">Here β&lt;0β&lt;0 is the decay rate. The decay rate corresponding to radius has the same effect on the radius as the decay rate corresponding to the learning rate. To gain a deeper insight into the behavior of the neighborhood function, let's plot it against the distance for different values of the radius. A point to note in these graphs is that the distance function approaches a near-zero value as the distance exceeds 10 for σ2≤10σ2≤10.</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="6d9e93d03e434c51856883248cd83623"><span data-offset-key="6d9e93d03e434c51856883248cd83623:0">We'll use this fact later to make training more efficient in the implementation part:</span></span></span>

    distance = np.arange(0, 30)sigma_sq = [0.1, 1, 10, 100]fig,ax = plt.subplots(nrows=1, ncols=4, figsize=(15,4))plt_ind = np.arange(4) + 141for s, ind in zip(sigma_sq, plt_ind):    plt.subplot(ind)    f = np.exp(-distance ** 2 / 2 / s)    plt.plot(distance, f, c='cyan')    plt.title('$\sigma^2$ = ' + str(s))    plt.xlabel('Distance')    plt.ylabel('Neighborhood function $f$')fig.subplots_adjust(hspace=0.5, wspace=0.3)plt.show()

<figure><img src="https://s3.stackabuse.com/media/articles/self-organizing-maps-theory-and-implementation-in-python-with-numpy-2.png" alt="decay rate for self organizing maps" class="image-52799b3c" /><figcaption><span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1" style="max-width:100%">decay rate for self organizing maps</span></figcaption></figure>

### 

<span class="text-4505230f--HeadingH400-686c0942--textContentFamily-49a318e1"><span data-key="58a2d4ff6f574fde9564ebd2b0b76654"><span data-offset-key="58a2d4ff6f574fde9564ebd2b0b76654:0">Implementing a Self-Organizing Map in Python Using NumPy</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="fbcf5b1d8d7d44ccbe15caa90d69f95b"><span data-offset-key="fbcf5b1d8d7d44ccbe15caa90d69f95b:0">As there is no built-in routine for an SOM in the de-facto standard machine learning library, </span><span data-offset-key="fbcf5b1d8d7d44ccbe15caa90d69f95b:1">***Scikit-Learn***</span><span data-offset-key="fbcf5b1d8d7d44ccbe15caa90d69f95b:2">, we'll do a quick implementation manually using </span><span data-offset-key="fbcf5b1d8d7d44ccbe15caa90d69f95b:3">***NumPy***</span><span data-offset-key="fbcf5b1d8d7d44ccbe15caa90d69f95b:4">. The unsupervised machine learning model is pretty straightforward and easy to implement.</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="76a424400b8d48fda108cb7dd77d521c"><span data-offset-key="76a424400b8d48fda108cb7dd77d521c:0">We'll implement the SOM as a 2D </span><span data-offset-key="76a424400b8d48fda108cb7dd77d521c:1">`mxn`</span><span data-offset-key="76a424400b8d48fda108cb7dd77d521c:2"> grid, hence requiring a 3D </span><span data-offset-key="76a424400b8d48fda108cb7dd77d521c:3">`NumPy`</span><span data-offset-key="76a424400b8d48fda108cb7dd77d521c:4"> array. The third dimension is required for storing the weights in each cell:</span></span></span>

    # Return the (g,h) index of the BMU in the griddef find_BMU(SOM,x):    distSq = (np.square(SOM - x)).sum(axis=2)    return np.unravel_index(np.argmin(distSq, axis=None), distSq.shape)    # Update the weights of the SOM cells when given a single training example# and the model parameters along with BMU coordinates as a tupledef update_weights(SOM, train_ex, learn_rate, radius_sq,                    BMU_coord, step=3):    g, h = BMU_coord    #if radius is close to zero then only BMU is changed    if radius_sq < 1e-3:        SOM[g,h,:] += learn_rate * (train_ex - SOM[g,h,:])        return SOM    # Change all cells in a small neighborhood of BMU    for i in range(max(0, g-step), min(SOM.shape[0], g+step)):        for j in range(max(0, h-step), min(SOM.shape[1], h+step)):            dist_sq = np.square(i - g) + np.square(j - h)            dist_func = np.exp(-dist_sq / 2 / radius_sq)            SOM[i,j,:] += learn_rate * dist_func * (train_ex - SOM[i,j,:])       return SOM    ​# Main routine for training an SOM. It requires an initialized SOM grid# or a partially trained grid as parameterdef train_SOM(SOM, train_data, learn_rate = .1, radius_sq = 1,              lr_decay = .1, radius_decay = .1, epochs = 10):        learn_rate_0 = learn_rate    radius_0 = radius_sq    for epoch in np.arange(0, epochs):        rand.shuffle(train_data)              for train_ex in train_data:            g, h = find_BMU(SOM, train_ex)            SOM = update_weights(SOM, train_ex,                                  learn_rate, radius_sq, (g,h))        # Update learning rate and radius        learn_rate = learn_rate_0 * np.exp(-epoch * lr_decay)        radius_sq = radius_0 * np.exp(-epoch * radius_decay)                return SOM

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="fb49e6dc5d8f496dad9abe86011ed606"><span data-offset-key="fb49e6dc5d8f496dad9abe86011ed606:0">Let's break down the key functions used to implement a Self-Organizing Map:</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="b8b739136f754c409801175eeb5f27ff"><span data-offset-key="b8b739136f754c409801175eeb5f27ff:0">`find_BMU()`</span><span data-offset-key="b8b739136f754c409801175eeb5f27ff:1"> returns the grid cell coordinates of the best matching unit when given the </span><span data-offset-key="b8b739136f754c409801175eeb5f27ff:2">`SOM`</span><span data-offset-key="b8b739136f754c409801175eeb5f27ff:3"> grid and a training example </span><span data-offset-key="b8b739136f754c409801175eeb5f27ff:4">`x`</span><span data-offset-key="b8b739136f754c409801175eeb5f27ff:5">. It computes the square of the Euclidean distance between each cell weight and </span><span data-offset-key="b8b739136f754c409801175eeb5f27ff:6">`x`</span><span data-offset-key="b8b739136f754c409801175eeb5f27ff:7">, and returns </span><span data-offset-key="b8b739136f754c409801175eeb5f27ff:8">`(g,h)`</span><span data-offset-key="b8b739136f754c409801175eeb5f27ff:9">, i.e., the cell coordinates with the minimum distance.</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="93c7b24e561f489eba3c47878d808004"><span data-offset-key="93c7b24e561f489eba3c47878d808004:0">The </span><span data-offset-key="93c7b24e561f489eba3c47878d808004:1">`update_weights()`</span><span data-offset-key="93c7b24e561f489eba3c47878d808004:2"> function requires an SOM grid, a training example </span><span data-offset-key="93c7b24e561f489eba3c47878d808004:3">`x`</span><span data-offset-key="93c7b24e561f489eba3c47878d808004:4">, the parameters </span><span data-offset-key="93c7b24e561f489eba3c47878d808004:5">`learn_rate`</span><span data-offset-key="93c7b24e561f489eba3c47878d808004:6"> and </span><span data-offset-key="93c7b24e561f489eba3c47878d808004:7">`radius_sq`</span><span data-offset-key="93c7b24e561f489eba3c47878d808004:8">, the coordinates of the best matching unit, and a </span><span data-offset-key="93c7b24e561f489eba3c47878d808004:9">`step`</span><span data-offset-key="93c7b24e561f489eba3c47878d808004:10"> parameter. Theoretically, all cells of the SOM are updated on the next training example. However, we showed earlier that the change is negligible for cells that are far away from the BMU. Hence, we can make the code more efficient by changing only the cells in a small vicinity of the BMU. The </span><span data-offset-key="93c7b24e561f489eba3c47878d808004:11">`step`</span><span data-offset-key="93c7b24e561f489eba3c47878d808004:12"> parameter specifies the maximum number of cells on the left, right, above, and below to change when updating the weights.</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="435e46874b8e43a8847b9f6e90e9fab4"><span data-offset-key="435e46874b8e43a8847b9f6e90e9fab4:0">Finallt, the </span><span data-offset-key="435e46874b8e43a8847b9f6e90e9fab4:1">`train_SOM()`</span><span data-offset-key="435e46874b8e43a8847b9f6e90e9fab4:2"> function implements the main training procedure of an SOM. It requires an initialized or partially trained </span><span data-offset-key="435e46874b8e43a8847b9f6e90e9fab4:3">`SOM`</span><span data-offset-key="435e46874b8e43a8847b9f6e90e9fab4:4"> grid and </span><span data-offset-key="435e46874b8e43a8847b9f6e90e9fab4:5">`train_data`</span><span data-offset-key="435e46874b8e43a8847b9f6e90e9fab4:6"> as parameters. The advantage is to be able to train the SOM from a previous trained stage. Additionally </span><span data-offset-key="435e46874b8e43a8847b9f6e90e9fab4:7">`learn_rate`</span><span data-offset-key="435e46874b8e43a8847b9f6e90e9fab4:8"> and </span><span data-offset-key="435e46874b8e43a8847b9f6e90e9fab4:9">`radius_sq`</span><span data-offset-key="435e46874b8e43a8847b9f6e90e9fab4:10"> parameters are required along with their corresponding decay rates </span><span data-offset-key="435e46874b8e43a8847b9f6e90e9fab4:11">`lr_decay`</span><span data-offset-key="435e46874b8e43a8847b9f6e90e9fab4:12"> and </span><span data-offset-key="435e46874b8e43a8847b9f6e90e9fab4:13">`radius_decay`</span><span data-offset-key="435e46874b8e43a8847b9f6e90e9fab4:14">. The </span><span data-offset-key="435e46874b8e43a8847b9f6e90e9fab4:15">`epochs`</span><span data-offset-key="435e46874b8e43a8847b9f6e90e9fab4:16"> parameter is set to 10 by default but can be changed if needed.</span></span></span>

### 

<span class="text-4505230f--HeadingH400-686c0942--textContentFamily-49a318e1"><span data-key="e6c607db272e42279c88f528a3650995"><span data-offset-key="e6c607db272e42279c88f528a3650995:0">Running the Self-Organizing Map on a Practical Example</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="97a1d740a1ac427d8250d26536486d39"><span data-offset-key="97a1d740a1ac427d8250d26536486d39:0">One of the commonly cited examples for training an SOM is that of random colors. We can train an SOM grid and easily visualize how various similar colors get arranged in neighboring cells.</span></span></span>

> <span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="585de12928c443d88c9f6bf61b0025b2"><span data-offset-key="585de12928c443d88c9f6bf61b0025b2:0">Cells far away from each other have different colors.</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="f9cab03014ad4707836542103f190889"><span data-offset-key="f9cab03014ad4707836542103f190889:0">Let's run the </span><span data-offset-key="f9cab03014ad4707836542103f190889:1">`train_SOM()`</span><span data-offset-key="f9cab03014ad4707836542103f190889:2"> function on a training data matrix filled with random RGB colors.</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="b23396e7309c4810a9caa1170af8350e"><span data-offset-key="b23396e7309c4810a9caa1170af8350e:0">The code below initializes a training data matrix and an SOM grid with random RGB colors. It also displays the training data and the randomly initialized </span><span data-offset-key="b23396e7309c4810a9caa1170af8350e:1">*SOM grid*</span><span data-offset-key="b23396e7309c4810a9caa1170af8350e:2">. Note, the training matrix is a 3000x3 matrix, however, we have reshaped it to 50x60x3 matrix for visualization:</span></span></span>

    # Dimensions of the SOM gridm = 10n = 10# Number of training examplesn_x = 3000rand = np.random.RandomState(0)# Initialize the training datatrain_data = rand.randint(0, 255, (n_x, 3))# Initialize the SOM randomlySOM = rand.randint(0, 255, (m, n, 3)).astype(float)# Display both the training matrix and the SOM gridfig, ax = plt.subplots(    nrows=1, ncols=2, figsize=(12, 3.5),     subplot_kw=dict(xticks=[], yticks=[]))ax[0].imshow(train_data.reshape(50, 60, 3))ax[0].title.set_text('Training Data')ax[1].imshow(SOM.astype(int))ax[1].title.set_text('Randomly Initialized SOM Grid')

<figure><img src="https://s3.stackabuse.com/media/articles/self-organizing-maps-theory-and-implementation-in-python-with-numpy-3.png" alt="randomly initialized self organizing map" class="image-52799b3c" /><figcaption><span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1" style="max-width:100%">randomly initialized self organizing map</span></figcaption></figure>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="b40bc4470c374814b73dcb98111d016e"><span data-offset-key="b40bc4470c374814b73dcb98111d016e:0">Let's now train the SOM and check up on it every 5 epochs as a quick overview of its progress:</span></span></span>

    fig, ax = plt.subplots(    nrows=1, ncols=4, figsize=(15, 3.5),     subplot_kw=dict(xticks=[], yticks=[]))total_epochs = 0for epochs, i in zip([1, 4, 5, 10], range(0,4)):    total_epochs += epochs    SOM = train_SOM(SOM, train_data, epochs=epochs)    ax[i].imshow(SOM.astype(int))    ax[i].title.set_text('Epochs = ' + str(total_epochs))

<figure><img src="https://s3.stackabuse.com/media/articles/self-organizing-maps-theory-and-implementation-in-python-with-numpy-4.png" alt="self organizing map training and results" class="image-52799b3c" /><figcaption><span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1" style="max-width:100%">self organizing map training and results</span></figcaption></figure>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="e98b719a05d54ea7bd5124b7dcb54648"><span data-offset-key="e98b719a05d54ea7bd5124b7dcb54648:0">The example above is very interesting as it shows how the grid automatically arranges the RGB colors so that various shades of the same color are close together in the SOM grid. The arrangement takes place as early as the first epoch, but it's not ideal. We can see that the SOM converges in around 10 epochs and there are fewer changes in the subsequent epochs.</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="5015edcb8c2b4eb7bbfda8c3d0937c33"><span data-offset-key="5015edcb8c2b4eb7bbfda8c3d0937c33:0">**Effect of Learning Rate and Radius**</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="dd3d7b3c400444bf87ded0fa75cf0501"><span data-offset-key="dd3d7b3c400444bf87ded0fa75cf0501:0">To see how the learning rate varies for different learning rates and radii, we can run the SOM for 10 epochs when starting from the same initial grid. The code below trains the SOM for three different values of the learning rate and three different radii.</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="2c4a61b18f2b48b1892431e52b2bc311"><span data-offset-key="2c4a61b18f2b48b1892431e52b2bc311:0">The SOM is rendered after 5 epochs for each simulation:</span></span></span>

    fig, ax = plt.subplots(    nrows=3, ncols=3, figsize=(15, 15),     subplot_kw=dict(xticks=[], yticks=[]))​# Initialize the SOM randomly to the same state​for learn_rate, i in zip([0.001, 0.5, 0.99], [0, 1, 2]):    for radius_sq, j in zip([0.01, 1, 10], [0, 1, 2]):        rand = np.random.RandomState(0)        SOM = rand.randint(0, 255, (m, n, 3)).astype(float)                SOM = train_SOM(SOM, train_data, epochs = 5,                        learn_rate = learn_rate,                         radius_sq = radius_sq)        ax[i][j].imshow(SOM.astype(int))        ax[i][j].title.set_text('$\eta$ = ' + str(learn_rate) +                                 ', $\sigma^2$ = ' + str(radius_sq))

<figure><img src="https://s3.stackabuse.com/media/articles/self-organizing-maps-theory-and-implementation-in-python-with-numpy-5.png" alt="effects and tuning self organizing map hyperparameters" class="image-52799b3c" /><figcaption><span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1" style="max-width:100%">effects and tuning self organizing map hyperparameters</span></figcaption></figure>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="c053edd5572746ddab7071ba97303db3"><span data-offset-key="c053edd5572746ddab7071ba97303db3:0">The example above shows that for radius values close to zero (first column), the SOM only changes the individual cells but not the neighboring cells. Hence, a proper map is not created regardless of the learning rate. A similar case is also encountered for smaller learning rates (first row, second column). As with any other machine learning algorithm, a good balance of parameters is required for ideal training.</span></span></span>

### 

<span class="text-4505230f--HeadingH400-686c0942--textContentFamily-49a318e1"><span data-key="f399cb4bc9db4ce09cdeeed6d5fa8b78"><span data-offset-key="f399cb4bc9db4ce09cdeeed6d5fa8b78:0">Conclusions</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="2a0772511b9d459989830b45a8d23fa5"><span data-offset-key="2a0772511b9d459989830b45a8d23fa5:0">In this guide, we discussed the theoretical model of an SOM and its detailed implementation. We demonstrated the SOM on RGB colors and showed how different shades of the same color organized themselves on a 2D grid.</span></span></span>

<span class="text-4505230f--TextH400-3033861f--textContentFamily-49a318e1"><span data-key="aca3d31486ea4c8d8c053f382277bbc6"><span data-offset-key="aca3d31486ea4c8d8c053f382277bbc6:0">While the SOMs are no longer very popular in the machine learning community, they remain a good model for data summary and visualization.</span></span></span>

<a href="../subject.html" class="reset-3c756112--card-6570f064--whiteCard-fff091a4--cardPrevious-56a5e674"></a>

<span class="text-4505230f--TextH200-a3425406--textContentFamily-49a318e1">Aux-Exploration - Previous</span>

<span class="text-4505230f--UIH400-4e41e82a--textContentFamily-49a318e1">Related Studies</span>

<a href="list-directory-contents.html" class="reset-3c756112--card-6570f064--whiteCard-fff091a4--cardNext-19241c42"></a>

<span class="text-4505230f--TextH200-a3425406--textContentFamily-49a318e1">Next</span>

<span class="text-4505230f--UIH400-4e41e82a--textContentFamily-49a318e1">List Directory Contents</span>

<img src="https://avatars.githubusercontent.com/u/66654881?v=4" class="image-67b14f24--avatar-1c1d03ec" />

<span class="text-4505230f--TextH200-a3425406--textContentFamily-49a318e1">Last updated 6 days ago</span>

<a href="https://github.com/bgoonz/python-gitbook/blob/master/aux-exploration/subject/self-organizing-maps-theory-and-implementation-in-python-with-numpy.md" class="reset-3c756112--menuItem-aa02f6ec--menuItemLight-757d5235--menuItemInline-173bdf97--pageSideMenuItem-22949732"></a>

<span class="text-4505230f--UIH300-2063425d--textUIFamily-5ebd8e40">Edit on GitHub</span>
